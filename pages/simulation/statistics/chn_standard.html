<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>통계분석</title>
    <meta http-equiv="Content-Script-Type" content="text/javascript" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="../../../css/lib/bootstrap.min.css" />
    <link rel="stylesheet" href="../../../css/lib/jquery-ui.css" />
    <link rel="stylesheet" href="../../../AUIGrid/AUIGrid_modern_style.css" />
    <link rel="stylesheet" href="../../../css/core/style.css" />
    <link rel="stylesheet" href="../../../css/core/main.css" />
    <link rel="stylesheet" href="../../../css/core/main_extra.css" />
    <link rel="stylesheet" href="../../../css/core/style_sub.css" />

    <script src="../../../js/lib/jquery.js"></script>
    <script src="../../../js/lib/vue.js"></script>
    <script src="../../../js/lib/bootstrap.js"></script>
    <script src="../../../AUIGrid/AUIGrid.js"></script>
    <script src="../../../AUIGrid/AUIGridLicense.js"></script>
    <script src="../../../js/all.min.js"></script>
    <script src="../../../js/summaryModal.js"></script>
  </head>
  <body>
    <div class="container-fluid">
      <div class="pt-3 standard">
        <div class="card card-box mr-0 p-4">
          <p class="card-tit">채널기준 시청률 적확률 Top3<span class="ic-noti"><i class="fa-solid fa-circle-info pl-2 "></i><div class="noti-box">시청률 실적 vs 사용자 정의 적확률</div></span></p>
          <div class="row">
            <div class="col-lg-3 pr-0">
              <div class="card mr-0">
                <div class="card-header">수도권-프라임</div>
                <div class="card-body">
                  <div class="program-table">
                    <table class="table mb-0">
                      <colgroup>
                        <col style="width: 70%;" />
                        <col style="width: 10%;" />
                        <col style="width: 10%;" />
                        <col style="width: 10%;" />
                      </colgroup>
                      <thead>
                        <tr>
                          <th></th>
                          <th>적확률</th>
                          <th>실적</th>
                          <th>예상</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td>2023년 시나리오 01</td>
                          <td>101%</td>
                          <td>3.21</td>
                          <td>3.18</td>
                        </tr>
                        <tr>
                          <td>2023년 시나리오 01</td>
                          <td>101%</td>
                          <td>3.21</td>
                          <td>3.18</td>
                        </tr>
                        <tr>
                          <td>2023년 시나리오 01</td>
                          <td>101%</td>
                          <td>3.21</td>
                          <td>3.18</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-lg-3 pr-0">
              <div class="card mr-0">
                <div class="card-header">수도권-데이</div>
                <div class="card-body">
                  <div class="program-table">
                    <table class="table mb-0">
                      <colgroup>
                        <col style="width: 70%;" />
                        <col style="width: 10%;" />
                        <col style="width: 10%;" />
                        <col style="width: 10%;" />
                      </colgroup>
                      <thead>
                        <tr>
                          <th></th>
                          <th>적확률</th>
                          <th>실적</th>
                          <th>예상</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td>2023년 시나리오 01</td>
                          <td>101%</td>
                          <td>3.21</td>
                          <td>3.18</td>
                        </tr>
                        <tr>
                          <td>2023년 시나리오 01</td>
                          <td>101%</td>
                          <td>3.21</td>
                          <td>3.18</td>
                        </tr>
                        <tr>
                          <td>2023년 시나리오 01</td>
                          <td>101%</td>
                          <td>3.21</td>
                          <td>3.18</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-lg-3 pr-0">
              <div class="card mr-0">
                <div class="card-header">전국-프라임</div>
                <div class="card-body">
                  <div class="program-table">
                    <table class="table mb-0">
                      <colgroup>
                        <col style="width: 70%;" />
                        <col style="width: 10%;" />
                        <col style="width: 10%;" />
                        <col style="width: 10%;" />
                      </colgroup>
                      <thead>
                        <tr>
                          <th></th>
                          <th>적확률</th>
                          <th>실적</th>
                          <th>예상</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td>2023년 시나리오 01</td>
                          <td>101%</td>
                          <td>3.21</td>
                          <td>3.18</td>
                        </tr>
                        <tr>
                          <td>2023년 시나리오 01</td>
                          <td>101%</td>
                          <td>3.21</td>
                          <td>3.18</td>
                        </tr>
                        <tr>
                          <td>2023년 시나리오 01</td>
                          <td>101%</td>
                          <td>3.21</td>
                          <td>3.18</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-lg-3">
              <div class="card mr-0">
                <div class="card-header">전국-데이</div>
                <div class="card-body">
                  <div class="program-table">
                    <table class="table mb-0">
                      <colgroup>
                        <col style="width: 70%;" />
                        <col style="width: 10%;" />
                        <col style="width: 10%;" />
                        <col style="width: 10%;" />
                      </colgroup>
                      <thead>
                        <tr>
                          <th></th>
                          <th>적확률</th>
                          <th>실적</th>
                          <th>예상</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td>2023년 시나리오 01</td>
                          <td>101%</td>
                          <td>3.21</td>
                          <td>3.18</td>
                        </tr>
                        <tr>
                          <td>2023년 시나리오 01</td>
                          <td>101%</td>
                          <td>3.21</td>
                          <td>3.18</td>
                        </tr>
                        <tr>
                          <td>2023년 시나리오 01</td>
                          <td>101%</td>
                          <td>3.21</td>
                          <td>3.18</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="card card-box mr-0 p-4 mt-4">
          <div class="d-flex justify-content-between">
            <div class="d-flex justify-content-start align-items-end">
              <div class="d-flex align-items-end">
                <div class="d-block">
                  <select class="form-control cj-selectBox select-box">
                    <option>2023</option>
                  </select>
                </div>

                <div class="d-block ml-4">
                  <select class="form-control cj-selectBox select-box">
                    <option>수도권</option>
                  </select>
                </div>
              </div>
            </div>

            <div class="d-flex cj-btn-group align-items-end">
              <button type="submit" class="btn btn-cj">조회</button>
            </div>
          </div>
          <!-- grid 영역 -->
          <p class="card-tit mt-4">시나리오 전체 리스트</p>
          <div id="app1">
            <div id="scenarioAllGrid" style="min-height: 400px"></div>
          </div>
        </div>


        <div class="card card-box mr-0 p-4 mt-4">
          <p class="card-tit">채널기준 상세</p>
          <div class="row">
            <div class="col-lg-6">
              <div class="card mr-0">
                <div class="card-header">채널기준 적확도(이벤트 포함)</div>
                <div class="card-body" style="height: 200px"></div>
              </div>
            </div>
            <div class="col-lg-6">
              <div class="card mr-0">
                <div class="card-header">채널기준 적확도(이벤트 제외)</div>
                <div class="card-body" style="height: 200px"></div>
              </div>
            </div>
          </div>

          <!-- grid 영역 -->
          <div class="d-flex cj-btn-group align-items-center justify-content-end mt-4">
            <button type="submit" class="btn btn-cj">엑셀저장</button>
          </div>
          <div id="app2" class="mt-4">
            <div id="scenarioDtlGrid" style="min-height: 400px"></div>
          </div>
        </div>

        <div class="card card-box mr-0 p-4 mt-4">
          <p class="card-tit">IP 기준 상세</p>
          <div class="row">
            <div class="col-lg-6">
              <div class="card mr-0">
                <div class="card-header">IP 기준 적확도(이벤트 포함)</div>
                <div class="card-body" style="height: 200px"></div>
              </div>
            </div>
            <div class="col-lg-6">
              <div class="card mr-0">
                <div class="card-header">IP 기준 적확도(이벤트 제외)</div>
                <div class="card-body" style="height: 200px"></div>
              </div>
            </div>
          </div>

          <!-- grid 영역 -->
          <div class="d-flex cj-btn-group align-items-center justify-content-end mt-4">
            <button type="submit" class="btn btn-cj">엑셀저장</button>
          </div>
          <div id="app3" class="mt-4">
            <div id="ipDtlGrid" style="min-height: 400px"></div>
          </div>
        </div>

        <div class="card card-box mr-0 p-4 mt-4">
          <p class="card-tit">적확률 상세</p>
          <div class="row">
            <div class="col-lg-4">
              <div class="card mr-0">
                <div class="card-header">실적vs사용자 정의(이벤트 포함)</div>
                <div class="card-body" style="height: 200px"></div>
              </div>
            </div>
            <div class="col-lg-4">
              <div class="card mr-0">
                <div class="card-header">실적 vs 표제비</div>
                <div class="card-body" style="height: 200px"></div>
              </div>
            </div>
            <div class="col-lg-4">
              <div class="card mr-0">
                <div class="card-header">실적 vs 시스템추천</div>
                <div class="card-body" style="height: 200px"></div>
              </div>
            </div>
          </div>

          <!-- grid 영역 -->
          <div class="d-flex cj-btn-group align-items-center justify-content-end mt-4">
            <button type="submit" class="btn btn-cj">엑셀저장</button>
          </div>
          <div id="app4" class="mt-4">
            <div id="acrDtlGrid" style="min-height: 400px"></div>
          </div>
        </div>

        <ul class="foot-menu mt-4">
          <li>메뉴1</li>
          <li>메뉴2</li>
          <li>메뉴3</li>
          <li><i class="fa-solid fa-arrow-up"></i></li>
        </ul>
      </div>
    </div>

    <script>

$(function () {
  $('[data-toggle="tooltip"]').tooltip()
})

      // 시나리오 전체 리스트
      let scenarioAllGrid = "";
      let app1 = {
        el: "#app1",
        watch: {
          gridData: function () {
            AUIGrid.setGridData(scenarioAllGrid, this.gridData);
          },
        },
        mounted() {
          scenarioAllGrid = AUIGrid.destroy("#scenarioAllGrid");
          scenarioAllGrid = AUIGrid.create("#scenarioAllGrid", this.gridLayout, this.gridProps);

          // 페이지 진입 시 기준년도 산출
          this.searchCommand.baseYear = new Date().getFullYear();
          // 기준년도 항목정의(과거:3년, 향후:5년)
          for (let idx = this.searchCommand.baseYear - 2; idx < this.searchCommand.baseYear + 5; idx += 1) {
            this.selectOptionItems.baseYear.push({ value: `${idx}`, text: `${idx}년` });
          }

          this.selectOptionItems.status.push({ value: "I", text: "진행중" });
          this.selectOptionItems.status.push({ value: "C", text: "확정" });

          this.search();
        },
        data: () => ({
          selectOptionItems: {
            baseYear: [{ value: "", text: "기준년도" }],
            genre: [{ value: "", text: "장르" }],
            status: [{ value: "", text: "채널그룹명" }],
          },
          searchCommand: {
            scenarioName: null,
            baseYear: "",
            genre: "",
            status: "",
          },
          gridData: [],
          gridLayout: [
            {
              dataField: "baseYear",
              headerText: "기준년도",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "scenario",
              headerText: "시나리오명",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "base",
              headerText: "기준",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "prime",
              headerText: "프라임",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "day",
              headerText: "데이",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "drama",
              headerText: "드라마",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "enter",
              headerText: "예능",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "pfmcCustom",
              headerText: "실적vs사용자정의",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "pfmcSystem",
              headerText: "실적vs시스템추천",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "pfmcHeadline",
              headerText: "실적vs표제비",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "event",
              headerText: "이벤트 적용 건수",
              children: [
                {
                  dataField: "chnStandard",
                  headerText: "채널기준",
                  editRenderer: {
                    type: "InputEditRenderer",
                    showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                    inputMode: "text",
                  },
                },
                {
                  dataField: "ipStandard",
                  headerText: "IP기준",
                  editRenderer: {
                    type: "InputEditRenderer",
                    showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                    inputMode: "text",
                  },
                },
              ], // end of children
            },
            {
              dataField: "",
              headerText: "",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "",
              headerText: "",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
          ],
          gridProps: {
            enableCellMerge: true,
            enableFilter: false,
            enableSorting: false,
            headerHeight: 38,
            headerHeights: [38, 38],
            rowHeight: 38,
            editingOnKeyDown: false,
            autoGridHeight: false,
            autoGridWidth: false,
            ignoreColumnMinWidth: true,
            softRemoveRowMode: false,
            // 행 번호 컬럼 활성화 속성입니다.
            showRowNumColumn: false,
            /*추가 옵션*/
            showStateColumn: false,
            editable: true,
            noDataMessage: "엑셀데이터를 붙여넣거나 행추가를 통해 데이터를 입력하세요.",
          },
        }),
        methods: {
          search: function () {
            console.log("search", this.searchCommand);
            this.setTestData();
          },
          createScenario: function () {
            this.$refs["refScenarioSummary"].draw();
          },
          edit: function (id) {
            console.log("준비중 edit", id);
          },
          version: function (id) {
            console.log("준비중 version", id);
          },
          copy: function (id) {
            console.log("준비중 copy", id);
          },
          remove: function (id) {
            console.log("준비중 remove", id);
          },
          done: function (id) {
            console.log("준비중 done", id);
          },
          setTestData: function () {
            this.gridData = [];
            this.gridData.push({
              baseYear: "2023",
              division: "지상파 채널",
              ep: "예상",
              january: "14.608",
              february: "15.990",
              march: "13.990",
              april: "12.990",
              may: "13.190",
              june: "13.290",
              july: "13.490",
              august: "15.690",
              september: "13.390",
              october: "13.290",
              november: "13.290",
              december: "13.290",
              year: "6.198",
            });
            this.gridData.push({
              baseYear: "2023",
              division: "지상파 채널",
              ep: "예상",
              january: "14.608",
              february: "15.990",
              march: "13.990",
              april: "12.990",
              may: "13.190",
              june: "13.290",
              july: "13.490",
              august: "15.690",
              september: "13.390",
              october: "13.290",
              november: "13.290",
              december: "13.290",
              year: "6.198",
            });
            this.gridData.push({
              baseYear: "2023",
              division: "종합편성 채널",
              ep: "예상",
              january: "14.608",
              february: "15.990",
              march: "13.990",
              april: "12.990",
              may: "13.190",
              june: "13.290",
              july: "13.490",
              august: "15.690",
              september: "13.390",
              october: "13.290",
              november: "13.290",
              december: "13.290",
              year: "6.198",
            });
            this.gridData.push({
              baseYear: "2023",
              division: "종합편성 채널",
              ep: "예상",
              january: "14.608",
              february: "15.990",
              march: "13.990",
              april: "12.990",
              may: "13.190",
              june: "13.290",
              july: "13.490",
              august: "15.690",
              september: "13.390",
              october: "13.290",
              november: "13.290",
              december: "13.290",
              year: "6.198",
            });
          },
        },
      };

      $(function () {
        new Vue(app1);
        Vue.nextTick(function () {
          $(window).resize(function () {
            AUIGrid.resize("#scenarioAllGrid");
          });
        });
        // Vue.component();
      });

      // 채널기준 상세
      let scenarioDtlGrid = "";
      let app2 = {
        el: "#app2",
        watch: {
          gridData: function () {
            AUIGrid.setGridData(scenarioDtlGrid, this.gridData);
          },
        },
        mounted() {
          scenarioDtlGrid = AUIGrid.destroy("#scenarioDtlGrid");
          scenarioDtlGrid = AUIGrid.create("#scenarioDtlGrid", this.gridLayout, this.gridProps);

          // 페이지 진입 시 기준년도 산출
          this.searchCommand.baseYear = new Date().getFullYear();
          // 기준년도 항목정의(과거:3년, 향후:5년)
          for (let idx = this.searchCommand.baseYear - 2; idx < this.searchCommand.baseYear + 5; idx += 1) {
            this.selectOptionItems.baseYear.push({ value: `${idx}`, text: `${idx}년` });
          }

          this.selectOptionItems.status.push({ value: "I", text: "진행중" });
          this.selectOptionItems.status.push({ value: "C", text: "확정" });

          this.search();
        },
        data: () => ({
          selectOptionItems: {
            baseYear: [{ value: "", text: "기준년도" }],
            genre: [{ value: "", text: "장르" }],
            status: [{ value: "", text: "채널그룹명" }],
          },
          searchCommand: {
            scenarioName: null,
            baseYear: "",
            genre: "",
            status: "",
          },
          gridData: [],
          gridLayout: [
            {
              dataField: "scenario",
              headerText: "시나리오명",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "region",
              headerText: "지역",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "watchTime",
              headerText: "시청시간",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "channelUnit",
              headerText: "채널단위",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "rating",
              headerText: "시청률",
              children: [
                {
                  dataField: "performance",
                  headerText: "실적(23.04월2주차)",
                  editRenderer: {
                    type: "InputEditRenderer",
                    showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                    inputMode: "text",
                  },
                },
                {
                  dataField: "custom",
                  headerText: "사용자정의",
                  children: [
                    {
                      dataField: "eventIn",
                      headerText: "이벤트포함",
                      editRenderer: {
                        type: "InputEditRenderer",
                        showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                        inputMode: "text",
                      },
                    },
                    {
                      dataField: "eventOut",
                      headerText: "이벤트제외",
                      editRenderer: {
                        type: "InputEditRenderer",
                        showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                        inputMode: "text",
                      },
                    },
                  ],
                },
              ], // end of children
            },
            {
              dataField: "accuracy",
              headerText: "적확도",
              children: [
                    {
                      dataField: "eventIn",
                      headerText: "이벤트포함",
                      editRenderer: {
                        type: "InputEditRenderer",
                        showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                        inputMode: "text",
                      },
                    },
                    {
                      dataField: "eventOut",
                      headerText: "이벤트제외",
                      editRenderer: {
                        type: "InputEditRenderer",
                        showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                        inputMode: "text",
                      },
                    },
                  ],
            },
            {
              dataField: "event",
              headerText: "이벤트",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
          ],
          gridProps: {
            enableCellMerge: true,
            enableFilter: false,
            enableSorting: false,
            headerHeight: 38,
            headerHeights: [38, 38],
            rowHeight: 38,
            editingOnKeyDown: false,
            autoGridHeight: false,
            autoGridWidth: false,
            ignoreColumnMinWidth: true,
            softRemoveRowMode: false,
            // 행 번호 컬럼 활성화 속성입니다.
            showRowNumColumn: false,
            /*추가 옵션*/
            showStateColumn: false,
            editable: true,
            noDataMessage: "엑셀데이터를 붙여넣거나 행추가를 통해 데이터를 입력하세요.",
          },
        }),
        methods: {
          search: function () {
            console.log("search", this.searchCommand);
            this.setTestData();
          },
          createScenario: function () {
            this.$refs["refScenarioSummary"].draw();
          },
          edit: function (id) {
            console.log("준비중 edit", id);
          },
          version: function (id) {
            console.log("준비중 version", id);
          },
          copy: function (id) {
            console.log("준비중 copy", id);
          },
          remove: function (id) {
            console.log("준비중 remove", id);
          },
          done: function (id) {
            console.log("준비중 done", id);
          },
          setTestData: function () {
            this.gridData = [];
            this.gridData.push({
              baseYear: "2023",
              division: "지상파 채널",
              ep: "예상",
              january: "14.608",
              february: "15.990",
              march: "13.990",
              april: "12.990",
              may: "13.190",
              june: "13.290",
              july: "13.490",
              august: "15.690",
              september: "13.390",
              october: "13.290",
              november: "13.290",
              december: "13.290",
              year: "6.198",
            });
            this.gridData.push({
              baseYear: "2023",
              division: "지상파 채널",
              ep: "예상",
              january: "14.608",
              february: "15.990",
              march: "13.990",
              april: "12.990",
              may: "13.190",
              june: "13.290",
              july: "13.490",
              august: "15.690",
              september: "13.390",
              october: "13.290",
              november: "13.290",
              december: "13.290",
              year: "6.198",
            });
            this.gridData.push({
              baseYear: "2023",
              division: "종합편성 채널",
              ep: "예상",
              january: "14.608",
              february: "15.990",
              march: "13.990",
              april: "12.990",
              may: "13.190",
              june: "13.290",
              july: "13.490",
              august: "15.690",
              september: "13.390",
              october: "13.290",
              november: "13.290",
              december: "13.290",
              year: "6.198",
            });
            this.gridData.push({
              baseYear: "2023",
              division: "종합편성 채널",
              ep: "예상",
              january: "14.608",
              february: "15.990",
              march: "13.990",
              april: "12.990",
              may: "13.190",
              june: "13.290",
              july: "13.490",
              august: "15.690",
              september: "13.390",
              october: "13.290",
              november: "13.290",
              december: "13.290",
              year: "6.198",
            });
          },
        },
      };

      $(function () {
        new Vue(app2);
        Vue.nextTick(function () {
          $(window).resize(function () {
            AUIGrid.resize("#scenarioDtlGrid");
          });
        });
        // Vue.component();
      });
   
       // IP 기준 상세
       let ipDtlGrid = "";
      let app3 = {
        el: "#app3",
        watch: {
          gridData: function () {
            AUIGrid.setGridData(ipDtlGrid, this.gridData);
          },
        },
        mounted() {
          ipDtlGrid = AUIGrid.destroy("#ipDtlGrid");
          ipDtlGrid = AUIGrid.create("#ipDtlGrid", this.gridLayout, this.gridProps);

          // 페이지 진입 시 기준년도 산출
          this.searchCommand.baseYear = new Date().getFullYear();
          // 기준년도 항목정의(과거:3년, 향후:5년)
          for (let idx = this.searchCommand.baseYear - 2; idx < this.searchCommand.baseYear + 5; idx += 1) {
            this.selectOptionItems.baseYear.push({ value: `${idx}`, text: `${idx}년` });
          }

          this.selectOptionItems.status.push({ value: "I", text: "진행중" });
          this.selectOptionItems.status.push({ value: "C", text: "확정" });

          this.search();
        },
        data: () => ({
          selectOptionItems: {
            baseYear: [{ value: "", text: "기준년도" }],
            genre: [{ value: "", text: "장르" }],
            status: [{ value: "", text: "채널그룹명" }],
          },
          searchCommand: {
            scenarioName: null,
            baseYear: "",
            genre: "",
            status: "",
          },
          gridData: [],
          gridLayout: [
            {
              dataField: "scenario",
              headerText: "시나리오명",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "region",
              headerText: "지역",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "watchTime",
              headerText: "시청시간",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "ipUnit",
              headerText: "IP단위",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "rating",
              headerText: "시청률",
              children: [
                {
                  dataField: "performance",
                  headerText: "실적(23.04월2주차)",
                  editRenderer: {
                    type: "InputEditRenderer",
                    showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                    inputMode: "text",
                  },
                },
                {
                  dataField: "custom",
                  headerText: "사용자정의",
                  children: [
                    {
                      dataField: "eventIn",
                      headerText: "이벤트포함",
                      editRenderer: {
                        type: "InputEditRenderer",
                        showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                        inputMode: "text",
                      },
                    },
                    {
                      dataField: "eventOut",
                      headerText: "이벤트제외",
                      editRenderer: {
                        type: "InputEditRenderer",
                        showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                        inputMode: "text",
                      },
                    },
                  ],
                },
              ], // end of children
            },
            {
              dataField: "accuracy",
              headerText: "적확도",
              children: [
                    {
                      dataField: "eventIn",
                      headerText: "이벤트포함",
                      editRenderer: {
                        type: "InputEditRenderer",
                        showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                        inputMode: "text",
                      },
                    },
                    {
                      dataField: "eventOut",
                      headerText: "이벤트제외",
                      editRenderer: {
                        type: "InputEditRenderer",
                        showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                        inputMode: "text",
                      },
                    },
                  ],
            },
            {
              dataField: "event",
              headerText: "이벤트",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
          ],
          gridProps: {
            enableCellMerge: true,
            enableFilter: false,
            enableSorting: false,
            headerHeight: 38,
            headerHeights: [38, 38],
            rowHeight: 38,
            editingOnKeyDown: false,
            autoGridHeight: false,
            autoGridWidth: false,
            ignoreColumnMinWidth: true,
            softRemoveRowMode: false,
            // 행 번호 컬럼 활성화 속성입니다.
            showRowNumColumn: false,
            /*추가 옵션*/
            showStateColumn: false,
            editable: true,
            noDataMessage: "엑셀데이터를 붙여넣거나 행추가를 통해 데이터를 입력하세요.",
          },
        }),
        methods: {
          search: function () {
            console.log("search", this.searchCommand);
            this.setTestData();
          },
          createScenario: function () {
            this.$refs["refScenarioSummary"].draw();
          },
          edit: function (id) {
            console.log("준비중 edit", id);
          },
          version: function (id) {
            console.log("준비중 version", id);
          },
          copy: function (id) {
            console.log("준비중 copy", id);
          },
          remove: function (id) {
            console.log("준비중 remove", id);
          },
          done: function (id) {
            console.log("준비중 done", id);
          },
          setTestData: function () {
            this.gridData = [];
            this.gridData.push({
              baseYear: "2023",
              division: "지상파 채널",
              ep: "예상",
              january: "14.608",
              february: "15.990",
              march: "13.990",
              april: "12.990",
              may: "13.190",
              june: "13.290",
              july: "13.490",
              august: "15.690",
              september: "13.390",
              october: "13.290",
              november: "13.290",
              december: "13.290",
              year: "6.198",
            });
            this.gridData.push({
              baseYear: "2023",
              division: "지상파 채널",
              ep: "예상",
              january: "14.608",
              february: "15.990",
              march: "13.990",
              april: "12.990",
              may: "13.190",
              june: "13.290",
              july: "13.490",
              august: "15.690",
              september: "13.390",
              october: "13.290",
              november: "13.290",
              december: "13.290",
              year: "6.198",
            });
            this.gridData.push({
              baseYear: "2023",
              division: "종합편성 채널",
              ep: "예상",
              january: "14.608",
              february: "15.990",
              march: "13.990",
              april: "12.990",
              may: "13.190",
              june: "13.290",
              july: "13.490",
              august: "15.690",
              september: "13.390",
              october: "13.290",
              november: "13.290",
              december: "13.290",
              year: "6.198",
            });
            this.gridData.push({
              baseYear: "2023",
              division: "종합편성 채널",
              ep: "예상",
              january: "14.608",
              february: "15.990",
              march: "13.990",
              april: "12.990",
              may: "13.190",
              june: "13.290",
              july: "13.490",
              august: "15.690",
              september: "13.390",
              october: "13.290",
              november: "13.290",
              december: "13.290",
              year: "6.198",
            });
          },
        },
      };

      $(function () {
        new Vue(app3);
        Vue.nextTick(function () {
          $(window).resize(function () {
            AUIGrid.resize("#ipDtlGrid");
          });
        });
        // Vue.component();
      });
   
       // IP 기준 상세
       let acrDtlGrid = "";
      let app4 = {
        el: "#app4",
        watch: {
          gridData: function () {
            AUIGrid.setGridData(acrDtlGrid, this.gridData);
          },
        },
        mounted() {
          acrDtlGrid = AUIGrid.destroy("#acrDtlGrid");
          acrDtlGrid = AUIGrid.create("#acrDtlGrid", this.gridLayout, this.gridProps);

          // 페이지 진입 시 기준년도 산출
          this.searchCommand.baseYear = new Date().getFullYear();
          // 기준년도 항목정의(과거:3년, 향후:5년)
          for (let idx = this.searchCommand.baseYear - 2; idx < this.searchCommand.baseYear + 5; idx += 1) {
            this.selectOptionItems.baseYear.push({ value: `${idx}`, text: `${idx}년` });
          }

          this.selectOptionItems.status.push({ value: "I", text: "진행중" });
          this.selectOptionItems.status.push({ value: "C", text: "확정" });

          this.search();
        },
        data: () => ({
          selectOptionItems: {
            baseYear: [{ value: "", text: "기준년도" }],
            genre: [{ value: "", text: "장르" }],
            status: [{ value: "", text: "채널그룹명" }],
          },
          searchCommand: {
            scenarioName: null,
            baseYear: "",
            genre: "",
            status: "",
          },
          gridData: [],
          gridLayout: [
            {
              dataField: "scenario",
              headerText: "시나리오명",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "region",
              headerText: "지역",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "watchTime",
              headerText: "시청시간",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "ipUnit",
              headerText: "IP단위",
              editRenderer: {
                type: "InputEditRenderer",
                showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                inputMode: "text",
              },
            },
            {
              dataField: "rating",
              headerText: "시청률",
              children: [
                {
                  dataField: "performance",
                  headerText: "실적(23.04월2주차)",
                  editRenderer: {
                    type: "InputEditRenderer",
                    showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                    inputMode: "text",
                  },
                },
                {
                  dataField: "customInEvt",
                  headerText: "사용자정의(이벤트포함)",
                  editRenderer: {
                    type: "InputEditRenderer",
                    showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                    inputMode: "text",
                  },
                },
                {
                  dataField: "systemRecom",
                  headerText: "시스템추천",
                  editRenderer: {
                    type: "InputEditRenderer",
                    showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                    inputMode: "text",
                  },
                },
                {
                  dataField: "headline",
                  headerText: "표제비",
                  editRenderer: {
                    type: "InputEditRenderer",
                    showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                    inputMode: "text",
                  },
                },
              
              ], // end of children
            },
            {
              dataField: "accuracy",
              headerText: "적확도",
              children: [
                    {
                      dataField: "perfoCustom",
                      headerText: "실적vs사용자정의",
                      editRenderer: {
                        type: "InputEditRenderer",
                        showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                        inputMode: "text",
                      },
                    },
                    {
                      dataField: "perfoSystem",
                      headerText: "실적vs시스템추천",
                      editRenderer: {
                        type: "InputEditRenderer",
                        showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                        inputMode: "text",
                      },
                    },
                    {
                      dataField: "perfoHeadline",
                      headerText: "실적vs표제비",
                      editRenderer: {
                        type: "InputEditRenderer",
                        showEditorBtnOver: true, // 마우스 오버 시 에디터버턴 보이기
                        inputMode: "text",
                      },
                    },
                  ],
            },
          ],
          gridProps: {
            enableCellMerge: true,
            enableFilter: false,
            enableSorting: false,
            headerHeight: 38,
            headerHeights: [38, 38],
            rowHeight: 38,
            editingOnKeyDown: false,
            autoGridHeight: false,
            autoGridWidth: false,
            ignoreColumnMinWidth: true,
            softRemoveRowMode: false,
            // 행 번호 컬럼 활성화 속성입니다.
            showRowNumColumn: false,
            /*추가 옵션*/
            showStateColumn: false,
            editable: true,
            noDataMessage: "엑셀데이터를 붙여넣거나 행추가를 통해 데이터를 입력하세요.",
          },
        }),
        methods: {
          search: function () {
            console.log("search", this.searchCommand);
            this.setTestData();
          },
          createScenario: function () {
            this.$refs["refScenarioSummary"].draw();
          },
          edit: function (id) {
            console.log("준비중 edit", id);
          },
          version: function (id) {
            console.log("준비중 version", id);
          },
          copy: function (id) {
            console.log("준비중 copy", id);
          },
          remove: function (id) {
            console.log("준비중 remove", id);
          },
          done: function (id) {
            console.log("준비중 done", id);
          },
          setTestData: function () {
            this.gridData = [];
            this.gridData.push({
              baseYear: "2023",
              division: "지상파 채널",
              ep: "예상",
              january: "14.608",
              february: "15.990",
              march: "13.990",
              april: "12.990",
              may: "13.190",
              june: "13.290",
              july: "13.490",
              august: "15.690",
              september: "13.390",
              october: "13.290",
              november: "13.290",
              december: "13.290",
              year: "6.198",
            });
            this.gridData.push({
              baseYear: "2023",
              division: "지상파 채널",
              ep: "예상",
              january: "14.608",
              february: "15.990",
              march: "13.990",
              april: "12.990",
              may: "13.190",
              june: "13.290",
              july: "13.490",
              august: "15.690",
              september: "13.390",
              october: "13.290",
              november: "13.290",
              december: "13.290",
              year: "6.198",
            });
            this.gridData.push({
              baseYear: "2023",
              division: "종합편성 채널",
              ep: "예상",
              january: "14.608",
              february: "15.990",
              march: "13.990",
              april: "12.990",
              may: "13.190",
              june: "13.290",
              july: "13.490",
              august: "15.690",
              september: "13.390",
              october: "13.290",
              november: "13.290",
              december: "13.290",
              year: "6.198",
            });
            this.gridData.push({
              baseYear: "2023",
              division: "종합편성 채널",
              ep: "예상",
              january: "14.608",
              february: "15.990",
              march: "13.990",
              april: "12.990",
              may: "13.190",
              june: "13.290",
              july: "13.490",
              august: "15.690",
              september: "13.390",
              october: "13.290",
              november: "13.290",
              december: "13.290",
              year: "6.198",
            });
          },
        },
      };

      $(function () {
        new Vue(app4);
        Vue.nextTick(function () {
          $(window).resize(function () {
            AUIGrid.resize("#acrDtlGrid");
          });
        });
        // Vue.component();
      });
   
   </script>
  </body>
</html>
